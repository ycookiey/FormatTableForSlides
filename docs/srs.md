# 要件定義書：FormatTableForSlides

## 1. プロジェクト概要

### 1.1 プロダクト名
**FormatTableForSlides**

### 1.2 目的・コンセプト
ExcelやCSVなどのリストデータを、プレゼンテーションスライド（PowerPoint / Google Slides / Keynote）のレイアウトに最適化された「表オブジェクト」としてクリップボードへ出力するWebツール。
特に、縦に長いリストをスライド1枚に収めるための「複数列への段組み変換（スネークカラム）」を、手作業なしで瞬時に行うことを主目的とする。

### 1.3 ターゲットユーザー
*   **属性:** コンサルタント、企画職、エンジニアなど、資料作成頻度の高いビジネスパーソン。
*   **ニーズ:** 見た目の調整に時間をかけたくない。データの修正が発生した際、手戻りを最小限にしたい。

## 2. ユーザーワークフロー

本ツールにおけるユーザーの操作フローは以下の通りとする。

1.  **Input (入力):**
    ユーザーがExcelやテキストエディタからデータをコピーし、ツールの入力エリアに貼り付ける。
2.  **Adjust (調整):**
    プレビュー画面を見ながら、列数（段組み）、連番の有無、デザインテーマなどのオプション操作を行う。
3.  **Action (出力):**
    完成した表を「コピー」ボタンでクリップボードに格納し、プレゼンソフトへペーストする。

## 3. 機能要件 (Functional Requirements)

### 3.1 データ入力・読み込み機能
*   **テキスト入力エリア:**
    *   複数行のテキストデータの貼り付けを受け付ける。
    *   Excelからのコピー（タブ区切り）と、CSV（カンマ区切り）を自動判別して表データとして認識する。
*   **ヘッダー判定:**
    *   「1行目をヘッダーとして扱う」オプション（デフォルトON）。
    *   OFFの場合、入力された全行をデータ行として扱う。

### 3.2 レイアウト変形機能（コア機能）
縦に長いデータを、指定した「分割数」に応じて折り返し配置する機能。

*   **段組み（Split Columns）設定:**
    *   **分割数の指定:** ユーザーはデータを何セットの列に分割するかを指定できる（例: 1列～5列）。
    *   **配置ロジック（Down-then-Across）:**
        *   データは「上から下へ」配置され、指定行数に達したら「右の列」へ折り返す。
        *   **例:** データの順序が [1, 2, 3, 4, 5, 6, 7, 8] で「3分割」を指定した場合の配置結果：
            *   1列目: 1, 2, 3
            *   2列目: 4, 5, 6
            *   3列目: 7, 8, (空)
    *   **ヘッダーの複製:**
        *   段組みを行った際、各ブロックの最上部にヘッダー行を自動的に複製して付与する。
    *   **区切り設定:**
        *   ブロック間に「空白の列」を挿入するか、あるいは「罫線のみ」とするかを選択可能にする。

### 3.3 データ加工・編集機能
*   **自動連番（No.）付与:**
    *   入力データに番号が含まれていない場合でも、自動的にNo.列を先頭に追加する。
    *   **重要:** 連番はデータの「元の順序」に従って振られること（段組み後も、列をまたいで数字が続く形式）。
*   **数値フォーマット:**
    *   数値のみの列を自動検出し、3桁区切り（カンマ）を適用するオプション。
*   **配置（Align）の自動調整:**
    *   数値列は「右寄せ」、それ以外のテキストは「左寄せ」をデフォルトとする。ユーザーによる手動上書きも可能とする。

### 3.4 デザイン・スタイリング機能
PowerPoint等に貼り付けた際、CSSスタイルを維持させるための機能。

*   **テーマプリセット:**
    *   ビジネスで使いやすい配色セットを用意（Standard Blue, Dark Gray, Minimal, Accent Colorなど）。
*   **縞模様（ゼブラストライプ）:**
    *   行ごとに背景色を交互に変える機能。
    *   段組み変換された場合でも、視覚的に横のラインが揃うように（あるいはブロックごとに整合性が取れるように）背景色を適用する。
*   **密度（Density）設定:**
    *   セルの余白（padding）を「広め」「標準」「狭め」から選択可能にし、スライドの情報量に合わせて調整できるようにする。
*   **フォント設定:**
    *   OS標準の汎用フォント（游ゴシック、メイリオ、Arial等）を指定するCSSを埋め込む。

### 3.5 出力機能
*   **クリップボード書き込み:**
    *   生成されたHTML（スタイル付きテーブル）をクリップボードにコピーする。
    *   Excel等のスプレッドシートへの貼り付け互換性のため、プレーンテキスト形式も同時にクリップボードへセットする。
*   **ステータス通知:**
    *   コピー完了時に、画面上で明確なフィードバック（「コピーしました」等のトースト表示）を行う。

## 4. UI/UX構成案

### 4.1 画面レイアウト
PC利用を前提とした「左右分割（2ペイン）」または「上下分割」の構成とする。

*   **左パネル（設定・入力）:**
    *   上段：データ入力エリア（広めに確保）。
    *   中段：レイアウト設定（分割数のスライダーやボタン）。
    *   下段：デザインオプション（色、連番、密度）。
*   **右パネル（プレビュー）:**
    *   生成結果のリアルタイムプレビュー。
    *   背景はスライドを意識した白、または薄いグレー。
    *   画面追従する目立つ「コピー」ボタンを配置。

### 4.2 インタラクション
*   **リアルタイム反映:** 入力データの変更やオプションの切り替えは、即座にプレビューに反映されること（ボタン押下を待たない）。
*   **レスポンシブ:** 基本はPC向けだが、タブレット等の狭い画面でも操作不能にならないよう、パネルが縦積みに変わる等の配慮を行う。

## 5. 非機能要件 (Non-Functional Requirements)

### 5.1 セキュリティ・プライバシー
*   **クライアントサイド処理:**
    *   全てのデータ処理（パース、変換、生成）はブラウザ上のJavaScriptのみで完結させる。
    *   サーバーへのデータ送信は一切行わない。
    *   その旨を利用規約またはUI上に明記し、心理的安全性を担保する。

### 5.2 パフォーマンス
*   **応答速度:**
    *   数千行程度のデータであれば、入力からプレビュー反映まで遅延を感じさせない（数ミリ秒〜数十ミリ秒以内）こと。

### 5.3 互換性
*   **ブラウザ:** Chrome, Edge, Safari, Firefox の最新版。
*   **貼り付け先:** Microsoft PowerPoint (Windows/Mac/Web), Google Slides, Apple Keynote, LibreOffice Impress。

## 6. 将来的な拡張性 (Roadmap)
初期リリースには含めないが、将来的な実装を考慮する機能。

*   **画像保存:** デザイン崩れを完全に防ぐため、HTMLではなくPNG画像としてダウンロードする機能。
*   **行列入替:** データの縦横（行と列）を入れ替える機能。
*   **設定の保存:** ユーザーが好みのカラー設定や密度設定をブラウザに保存（Local Storage）できる機能。