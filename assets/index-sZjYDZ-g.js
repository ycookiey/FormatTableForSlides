(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();function x(e,t){const r=e.trim();if(!r)return{headers:[],rows:[],hasHeader:t};const o=r.split(/\r?\n/),n=C(r),s=o.map(a=>B(a,n)).filter(a=>a.length>0);if(s.length===0)return{headers:[],rows:[],hasHeader:t};if(t&&s.length>0)return{headers:s[0],rows:s.slice(1),hasHeader:!0};const i=Math.max(...s.map(a=>a.length));return{headers:Array(i).fill(""),rows:s,hasHeader:!1}}function C(e){const t=(e.match(/\t/g)||[]).length,r=(e.match(/,/g)||[]).length;return t>=r?"	":","}function B(e,t){const r=[];let o="",n=!1;for(let s=0;s<e.length;s++){const i=e[s],a=e[s+1];n?i==='"'&&a==='"'?(o+='"',s++):i==='"'?n=!1:o+=i:i==='"'?n=!0:i===t?(r.push(o.trim()),o=""):o+=i}return r.push(o.trim()),r}function I(e){const t=Math.max(e.headers.length,...e.rows.map(n=>n.length)),r=[...e.headers];for(;r.length<t;)r.push("");const o=e.rows.map(n=>{const s=[...n];for(;s.length<t;)s.push("");return s});return{headers:r,rows:o,hasHeader:e.hasHeader}}function H(e,t){if(t<=1||e.rows.length===0)return[e];const r=e.rows.length,o=Math.ceil(r/t),n=[];for(let s=0;s<t;s++){const i=s*o,a=Math.min(i+o,r);if(i>=r)n.push({headers:e.headers,rows:Array(o).fill(null).map(()=>Array(e.headers.length).fill("")),hasHeader:e.hasHeader});else{const u=e.rows.slice(i,a);for(;u.length<o;)u.push(Array(e.headers.length).fill(""));n.push({headers:e.headers,rows:u,hasHeader:e.hasHeader})}}return n}function L(e,t){if(e.length===0)return{headers:[],rows:[],hasHeader:!1};if(e.length===1)return e[0];const r=t.separatorType==="column",o=[],n=Math.max(...e.map(a=>a.rows.length)),s=Array(n).fill(null).map(()=>[]),i=[];return e.forEach((a,u)=>{if(u>0&&r){i.push(o.length),o.push("");for(let c=0;c<n;c++)s[c].push("")}o.push(...a.headers);for(let c=0;c<n;c++){const m=a.rows[c]||Array(a.headers.length).fill("");s[c].push(...m)}}),{headers:o,rows:s,hasHeader:e[0].hasHeader,separatorColumns:i.length>0?i:void 0}}function N(e,t){const r=H(e,t.splitColumns);return L(r,t)}function T(e){const t=["No.",...e.headers];let r=1;const o=e.rows.map(n=>n.every(i=>i==="")?["",...n]:[String(r++),...n]);return{headers:t,rows:o,hasHeader:e.hasHeader}}function A(e){const t=e.rows.map(r=>r.map(o=>z(o)));return{headers:e.headers,rows:t,hasHeader:e.hasHeader}}function z(e){const t=e.trim();if(!t||!/^-?\d+(\.\d+)?$/.test(t))return e;const o=parseFloat(t);return isNaN(o)?e:o.toLocaleString("ja-JP")}function S(e){const t=e.headers.length,r=[];for(let o=0;o<t;o++){const n=e.rows.map(s=>s[o]||"");r.push(P(n))}return r}function P(e){const t=e.filter(n=>n.trim()!=="");return t.length===0?"left":t.filter(n=>O(n)).length/t.length>=.5?"right":"left"}function O(e){const t=e.trim();return t?/^-?[\d,]+(\.\d+)?$/.test(t):!1}const $={"standard-blue":{headerBg:"#4472C4",headerText:"#FFFFFF",zebraEven:"#D6E3F8",zebraOdd:"#FFFFFF"},"dark-gray":{headerBg:"#404040",headerText:"#FFFFFF",zebraEven:"#E8E8E8",zebraOdd:"#FFFFFF"},minimal:{headerBg:"#F5F5F5",headerText:"#333333",zebraEven:"#FAFAFA",zebraOdd:"#FFFFFF"},"accent-green":{headerBg:"#70AD47",headerText:"#FFFFFF",zebraEven:"#E2EFDA",zebraOdd:"#FFFFFF"}},D={comfortable:"12px 16px",standard:"8px 12px",compact:"4px 8px"};function M(e,t){if(e.headers.length===0&&e.rows.length===0)return"";const r=$[t.theme],o=D[t.density],n=S(e),s=new Set(e.separatorColumns||[]);let a=`<table style="${`
    border-collapse: collapse;
    font-family: 'Segoe UI', 'Yu Gothic UI', 'Meiryo', sans-serif;
    font-size: 14px;
  `.replace(/\s+/g," ").trim()}">`;return e.hasHeader&&e.headers.some(u=>u!=="")&&(a+="<thead><tr>",e.headers.forEach((u,c)=>{if(s.has(c)){const m=w();a+=`<th style="${m}"></th>`}else{const m=b({backgroundColor:r.headerBg,color:r.headerText,fontWeight:"bold",padding:o,textAlign:n[c]||"left"});a+=`<th style="${m}">${F(u)}</th>`}}),a+="</tr></thead>"),a+="<tbody>",e.rows.forEach((u,c)=>{const m=c%2===0,E=t.zebra?m?r.zebraOdd:r.zebraEven:"#FFFFFF";a+="<tr>",u.forEach((v,y)=>{if(s.has(y)){const p=w();a+=`<td style="${p}"></td>`}else{const p=b({backgroundColor:E,padding:o,textAlign:n[y]||"left"});a+=`<td style="${p}">${F(v)}</td>`}}),a+="</tr>"}),a+="</tbody>",a+="</table>",a}function b(e){const t=["border: 1px solid #D0D0D0",`padding: ${e.padding}`,`text-align: ${e.textAlign}`];return e.backgroundColor&&t.push(`background-color: ${e.backgroundColor}`),e.color&&t.push(`color: ${e.color}`),e.fontWeight&&t.push(`font-weight: ${e.fontWeight}`),t.join("; ")}function w(){return["border: none","background-color: transparent","padding: 0 8px","width: 16px","min-width: 16px"].join("; ")}function F(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function R(e){const t=[];return e.hasHeader&&e.headers.some(r=>r!=="")&&t.push(e.headers.join("	")),e.rows.forEach(r=>{t.push(r.join("	"))}),t.join(`
`)}async function j(e,t){try{const r=new Blob([e],{type:"text/html"}),o=new Blob([t],{type:"text/plain"}),n=new ClipboardItem({"text/html":r,"text/plain":o});await navigator.clipboard.write([n])}catch(r){console.warn("Clipboard API failed, falling back to text-only:",r),await navigator.clipboard.writeText(t)}}function f(e,t=2e3){const r=document.getElementById("toast");r&&(r.textContent=e,r.classList.add("show"),setTimeout(()=>{r.classList.remove("show")},t))}const l={dataInput:document.getElementById("data-input"),splitColumns:document.getElementById("split-columns"),splitValue:document.getElementById("split-value"),headerOption:document.getElementById("header-option"),separatorType:document.getElementById("separator-type"),addNumbers:document.getElementById("add-numbers"),formatNumbers:document.getElementById("format-numbers"),theme:document.getElementById("theme"),zebra:document.getElementById("zebra"),density:document.getElementById("density"),preview:document.getElementById("preview"),copyButton:document.getElementById("copy-button"),sampleButton:document.getElementById("sample-button")},k=`名前	部署	売上
田中太郎	営業部	1234567
鈴木花子	開発部	987654
佐藤次郎	人事部	456789
山田三郎	総務部	123456
高橋四郎	経理部	789012
伊藤五郎	営業部	345678
渡辺六郎	開発部	567890
中村七子	人事部	234567`;let h="",g="";function V(){return{layout:{splitColumns:parseInt(l.splitColumns.value,10),separatorType:l.separatorType.value},style:{theme:l.theme.value,zebra:l.zebra.checked,density:l.density.value},format:{addNumbers:l.addNumbers.checked,formatNumbers:l.formatNumbers.checked},hasHeader:l.headerOption.checked}}function d(){const e=l.dataInput.value,t=V();if(!e.trim()){l.preview.innerHTML='<p class="placeholder-text">データを入力するとプレビューが表示されます</p>',l.preview.className="preview-area",h="",g="";return}let r=x(e,t.hasHeader);r=I(r),t.format.addNumbers&&(r=T(r)),t.format.formatNumbers&&(r=A(r)),r=N(r,t.layout),h=M(r,t.style),g=R(r),l.preview.innerHTML=h||'<p class="placeholder-text">データを入力するとプレビューが表示されます</p>',l.preview.className=`preview-area density-${t.style.density}`}function U(e,t){let r;return(...o)=>{clearTimeout(r),r=setTimeout(()=>e(...o),t)}}const W=U(d,100);function q(){l.dataInput.addEventListener("input",W),l.splitColumns.addEventListener("input",()=>{l.splitValue.textContent=l.splitColumns.value,d()}),l.headerOption.addEventListener("change",d),l.separatorType.addEventListener("change",d),l.addNumbers.addEventListener("change",d),l.formatNumbers.addEventListener("change",d),l.theme.addEventListener("change",d),l.zebra.addEventListener("change",d),l.density.addEventListener("change",d),l.sampleButton.addEventListener("click",()=>{l.dataInput.value=k,d()}),l.copyButton.addEventListener("click",async()=>{if(!h){f("コピーするデータがありません");return}try{await j(h,g),f("コピーしました！")}catch(e){console.error("Copy failed:",e),f("コピーに失敗しました")}})}q();d();
